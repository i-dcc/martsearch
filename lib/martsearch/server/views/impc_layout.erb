<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="no-js">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <% if ENV['RACK_ENV'] == "production" or ENV['RACK_ENV'] == "staging" %>
      <%= stylesheet_link_tag "/css/martsearch-#{MartSearch::Server::VERSION}.css", :media => 'all', :charset => 'utf-8' %>
      <%= stylesheet_link_tag '/css/print.css', :media => 'print', :charset => 'utf-8' %>
      <%= javascript_script_tag "/js/martsearch-head-#{MartSearch::Server::VERSION}.js", :charset => 'utf-8' %>
    <% else %>

      <% MartSearch::Server::DEFAULT_CSS_FILES.each do |css_file| %>
        <%= stylesheet_link_tag "/css/#{css_file}", :media => 'all', :charset => 'utf-8' %>
      <% end %>
      <%= stylesheet_link_tag '/css/print.css', :media => 'print', :charset => 'utf-8' %>
      <% @ms.dataviews.each do |view| %>
        <% unless view.stylesheet.nil? %>
          <%= stylesheet_link_tag "/dataview-css/#{view.internal_name}.css", :media => 'all', :charset => 'utf-8' %>
        <% end %>
      <% end %>

      <% MartSearch::Server::DEFAULT_HEAD_JS_FILES.each do |js_file| %>
        <%= javascript_script_tag "/js/#{js_file}", :charset => 'utf-8' %>
      <% end %>
      <% @ms.dataviews.each do |view| %>
        <% unless view.javascript_head.nil? %>
          <%= javascript_script_tag "/dataview-head-js/#{view.internal_name}.js", :charset => 'utf-8' %>
        <% end %>
      <% end %>
    <% end %>

    <script type="text/javascript" charset="utf-8">
      // Set the url of the software (for js that needs to know)...
      var martsearch_url = '<%= @request.script_name %>';

      // Google Analytics
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', '']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body>

      <div id="content">
        <%= yield %>
      </div>

  </body>
</html>
